<?php	header('Content-Type: application/json');	include("../conexi.php");	$link=Conectarse();		$respuesta = array();			$consulta = "SELECT *  FROM {$_GET["tabla"]} WHERE {$_GET["pk"]} = '{$_GET["folio"]}'";		$result = mysqli_query( $link, $consulta ) 	or die("Error al ejecutar consulta: $consulta".mysqli_error($link));				while($venta = mysqli_fetch_assoc($result)) {		$consulta_productos = "		SELECT * , COALESCE (entradas, 0) - COALESCE (salidas, 0) AS saldo				FROM  {$_GET["tabla_productos"]}		LEFT JOIN productos USING(id_productos)		LEFT JOIN ( 		SELECT		id_productos,		SUM(cantidad) AS entradas		FROM		entradas_productos		GROUP BY id_productos		)		AS t_entradas USING (id_productos)				LEFT JOIN (		SELECT		id_productos,		SUM(cantidad) AS salidas		FROM		salidas_productos 		GROUP BY id_productos		) AS t_salidas USING (id_productos)				WHERE {$_GET["pk"]} = '{$_GET["folio"]}'				";				$result_productos = mysqli_query( $link, $consulta_productos );		if($result_productos){			$respuesta["consulta_productos"][] = $consulta_productos; 						while($productos = mysqli_fetch_assoc($result_productos)) {				$respuesta["productos"][] = $productos; 								$venta["productos"][] = $productos; 											}		}		else{			$respuesta["result_productos"] = mysqli_error($link); 		}				$respuesta["ventas"][] =  $venta;			}		$respuesta["num_filas"] = mysqli_num_rows($result) ;			$respuesta["mensaje"] =  $count_rows < 1 ? $mensaje_error : "OK";	$respuesta["encontrado"] =  $count_rows < 1 ? 0 : 1;	$respuesta["consulta"] =  $consulta;			print(json_encode($respuesta));		?>	